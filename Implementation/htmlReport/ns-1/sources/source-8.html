


<!DOCTYPE html>
<html id="htmlId">
<head>
  <title>Coverage Report > TestUserManager</title>
  <style type="text/css">
    @import "../../css/coverage.css";
    @import "../../css/idea.min.css";
  </style>
  <script type="text/javascript" src="../../js/highlight.min.js"></script>
  <script type="text/javascript" src="../../js/highlightjs-line-numbers.min.js"></script>
</head>

<body>
<div class="content">
<div class="breadCrumbs">
Current scope:     <a href="../../index.html">all classes</a>
    <span class="separator">|</span>
    <a href="../index.html">test</a>
</div>

<h1>Coverage Summary for Class: TestUserManager (test)</h1>

<table class="coverageStats">
<tr>
  <th class="name">Class</th>
<th class="coverageStat 
">
  Class, %
</th>
<th class="coverageStat 
">
  Method, %
</th>
<th class="coverageStat 
">
  Line, %
</th>
</tr>
<tr>
  <td class="name">TestUserManager</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (18/18)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    95,9%
  </span>
  <span class="absValue">
    (71/74)
  </span>
</td>
</tr>

</table>

<br/>
<br/>


<pre>
<code class="sourceCode" id="sourceCode">&nbsp;package test;
&nbsp;
&nbsp;import static org.junit.Assert.assertNotNull;
&nbsp;import static org.junit.Assert.assertThrows;
&nbsp;import static org.junit.jupiter.api.Assertions.assertEquals;
&nbsp;import static org.mockito.ArgumentMatchers.any;
&nbsp;import static org.mockito.Mockito.*;
&nbsp;import static user.manager.UserManager.insertContabile;
&nbsp;/*
&nbsp;import java.sql.Connection;
&nbsp;import java.sql.PreparedStatement;
&nbsp;import java.sql.ResultSet;
&nbsp;import java.sql.SQLException;
&nbsp;import java.util.HashSet;
&nbsp;
&nbsp;import connection.ConPool;
&nbsp;import org.junit.jupiter.api.BeforeEach;
&nbsp;import org.junit.jupiter.api.Test;
&nbsp;import org.mockito.Mock;
&nbsp;import org.mockito.MockedStatic;
&nbsp;import org.mockito.Mockito;
&nbsp;import org.mockito.MockitoAnnotations;
&nbsp;
&nbsp;import user.bean.Gestore;
&nbsp;import user.manager.UserManager;
&nbsp;import user.bean.Utente;
&nbsp;
&nbsp;public class TestUserManager {
&nbsp;
&nbsp;    @Mock
&nbsp;    Connection connectionMock;
&nbsp;
&nbsp;    @Mock
&nbsp;    PreparedStatement preparedStatementMock;
&nbsp;
&nbsp;    @Mock
&nbsp;    ResultSet resultSetMock;
&nbsp;
&nbsp;    private Utente utente;
&nbsp;*/
&nbsp;   /* @BeforeEach
&nbsp;    public void init() throws SQLException {
&nbsp;        MockitoAnnotations.initMocks(this);
&nbsp;
&nbsp;        when(connectionMock.prepareStatement(any(String.class), any(Integer.class))).thenReturn(preparedStatementMock);
&nbsp;        when(connectionMock.prepareStatement(any(String.class))).thenReturn(preparedStatementMock);
&nbsp;        when(preparedStatementMock.executeUpdate()).thenReturn(1);
&nbsp;        when(preparedStatementMock.getGeneratedKeys()).thenReturn(resultSetMock);
&nbsp;        when(resultSetMock.next()).thenReturn(true).thenReturn(false);
&nbsp;        when(resultSetMock.getInt(1)).thenReturn(1);
&nbsp;        utente = UserManager.insertUser(&quot;John&quot;, &quot;Doe&quot;, &quot;john.doe@email.com&quot;, &quot;password&quot;, &quot;1234567890&quot;);
&nbsp;    }*/
&nbsp;
&nbsp;   /* @Test
&nbsp;    public void testCheckIdByEmail(){
&nbsp;        String email = &quot;prova@gmail.com&quot;;
&nbsp;        //MockedStatic&lt;UserManager&gt; mock = Mockito.mockStatic(UserManager.class);
&nbsp;        MockedStatic&lt;ConPool&gt; mockCon = Mockito.mockStatic(ConPool.class);
&nbsp;        when(()-&gt;ConPool.getConnection()).thenReturn(true);
&nbsp;        MockedStatic&lt;PreparedStatement&gt; mockPs = Mockito.mockStatic(PreparedStatement.class);
&nbsp;        when(()-&gt;(new PreparedStatement()).executeQuery()).thenReturn(true);
&nbsp;        MockedStatic&lt;ResultSet&gt; mockRs = Mockito.mockStatic(ResultSet.class);
&nbsp;        when(()-&gt;(new ResultSet()).next()).thenReturn(true);
&nbsp;
&nbsp;
&nbsp;        //mock.when(()-&gt;UserManager.checkIdByEmail(email)).thenReturn(m);
&nbsp;        assertEquals(true, UserManager.checkIdByEmail(email));
&nbsp;    }*/
&nbsp;
&nbsp;/*
&nbsp;    @Test
&nbsp;    public void testInsertUser() throws SQLException {
&nbsp;
&nbsp;        assertEquals(&quot;John&quot;, utente.getNome());
&nbsp;        assertEquals(&quot;Doe&quot;, utente.getCognome());
&nbsp;        assertEquals(&quot;john.doe@email.com&quot;, utente.getEmail());
&nbsp;        assertEquals(&quot;1234567890&quot;, utente.getTelefono());
&nbsp;    }
&nbsp;
&nbsp;    @Test
&nbsp;    public void testInsertCliente() throws SQLException {
&nbsp;        boolean result = UserManager.insertCliente(utente);
&nbsp;        assertEquals(true, result);
&nbsp;    }
&nbsp;
&nbsp;    @Test
&nbsp;    public void testInsertGestore() throws SQLException {
&nbsp;        Gestore g = UserManager.insertGestore(utente, &quot;party&quot;);
&nbsp;        assertEquals(true, g != null);
&nbsp;    }*/
&nbsp;//}
&nbsp;
&nbsp;import java.sql.Connection;
&nbsp;import java.sql.PreparedStatement;
&nbsp;import java.sql.ResultSet;
&nbsp;import java.sql.SQLException;
&nbsp;
&nbsp;import connection.ConPool;
&nbsp;import org.junit.Before;
&nbsp;import org.junit.jupiter.api.BeforeEach;
&nbsp;import org.junit.Test;
&nbsp;import org.junit.runner.RunWith;
&nbsp;import org.mockito.*;
&nbsp;import org.mockito.junit.MockitoJUnitRunner;
&nbsp;import user.bean.Contabile;
&nbsp;import user.bean.Gestore;
&nbsp;import user.bean.Utente;
&nbsp;import user.manager.UserManager;
&nbsp;
&nbsp;import javax.sql.DataSource;
&nbsp;
<b class="fc">&nbsp;@RunWith(MockitoJUnitRunner.class)</b>
<b class="fc">&nbsp;public class TestUserManager {</b>
&nbsp;    @Mock
&nbsp;    public Connection connection;
&nbsp;    @Mock
&nbsp;    public PreparedStatement preparedStatement;
&nbsp;    @Mock
&nbsp;    private ResultSet resultSet;
&nbsp;
&nbsp;
&nbsp;
&nbsp;    @Before
&nbsp;    public void setUp() throws SQLException {
&nbsp;        //assertNotNull(preparedStatement);
<b class="fc">&nbsp;        when(connection.prepareStatement(any(String.class))).thenReturn(preparedStatement);</b>
<b class="fc">&nbsp;        when(connection.prepareStatement(anyString(), anyInt())).thenReturn(preparedStatement);</b>
&nbsp;        //when(ConPool.getConnection()).thenReturn(connection);
&nbsp;        // when(ds.getConnection()).thenReturn(connection);
&nbsp;    }
&nbsp;
&nbsp;    //insertUser
&nbsp;    @Test
&nbsp;    public void testInsertUser(){
<b class="fc">&nbsp;        try (MockedStatic&lt;ConPool&gt; utilities = Mockito.mockStatic(ConPool.class)) {</b>
<b class="fc">&nbsp;            utilities.when(ConPool::getConnection).thenReturn(connection);</b>
<b class="fc">&nbsp;            when(preparedStatement.executeUpdate()).thenReturn(1);</b>
<b class="fc">&nbsp;            when(preparedStatement.getGeneratedKeys()).thenReturn(resultSet);</b>
<b class="fc">&nbsp;            when(resultSet.next()).thenReturn(true);</b>
<b class="fc">&nbsp;            when(resultSet.getInt(1)).thenReturn(1);</b>
&nbsp;
<b class="fc">&nbsp;            Utente result = UserManager.insertUser(&quot;nome1&quot;,&quot;cognome&quot;,&quot;email&quot;,&quot;password&quot;,&quot;telefono&quot;);</b>
<b class="fc">&nbsp;            assertEquals(1, result.getId());</b>
<b class="fc">&nbsp;            assertEquals(&quot;nome1&quot;, result.getNome());</b>
<b class="fc">&nbsp;            assertEquals(&quot;cognome&quot;, result.getCognome());</b>
<b class="fc">&nbsp;            assertEquals(&quot;email&quot;, result.getEmail());</b>
<b class="fc">&nbsp;            assertEquals(&quot;password&quot;, result.getPassword());</b>
<b class="fc">&nbsp;            assertEquals(&quot;telefono&quot;, result.getTelefono());</b>
<b class="fc">&nbsp;        } catch (SQLException e) {</b>
<b class="nc">&nbsp;            throw new RuntimeException(e);</b>
<b class="fc">&nbsp;        }</b>
&nbsp;    }
&nbsp;    @Test
&nbsp;    public void testInsertUser_InsertError() throws SQLException {
<b class="fc">&nbsp;        try (MockedStatic&lt;ConPool&gt; utilities = Mockito.mockStatic(ConPool.class)) {</b>
<b class="fc">&nbsp;            utilities.when(ConPool::getConnection).thenReturn(connection);</b>
<b class="fc">&nbsp;            when(preparedStatement.executeUpdate()).thenReturn(0);</b>
<b class="fc">&nbsp;            assertThrows(RuntimeException.class, () -&gt; {</b>
<b class="fc">&nbsp;                UserManager.insertUser(&quot;nome&quot;, &quot;cognome&quot;, &quot;email&quot;, &quot;password&quot;, &quot;telefono&quot;);</b>
&nbsp;            });
<b class="fc">&nbsp;        }</b>
&nbsp;    }
&nbsp;    @Test
&nbsp;    public void testInsertUser_SQLException() throws SQLException {
<b class="fc">&nbsp;        try (MockedStatic&lt;ConPool&gt; utilities = Mockito.mockStatic(ConPool.class)) {</b>
<b class="fc">&nbsp;            utilities.when(ConPool::getConnection).thenReturn(connection);</b>
&nbsp;            //when(connection.prepareStatement(&quot;INSERT INTO utente (nome, cognome, email, password, telefono) VALUES (?, ?, ?, ?, ?)&quot;)).thenThrow(new SQLException());
<b class="fc">&nbsp;            assertThrows(RuntimeException.class, () -&gt; {</b>
<b class="fc">&nbsp;                UserManager.insertUser(&quot;nome&quot;, &quot;cognome&quot;, &quot;email&quot;, &quot;password&quot;, &quot;telefono&quot;);</b>
&nbsp;            });
<b class="fc">&nbsp;        }</b>
&nbsp;    }
&nbsp;
&nbsp;    //insertCliente
&nbsp;    @Test
&nbsp;    public void testinsertCliente() {
<b class="fc">&nbsp;        try (MockedStatic&lt;ConPool&gt; utilities = Mockito.mockStatic(ConPool.class)) {</b>
<b class="fc">&nbsp;            utilities.when(ConPool::getConnection).thenReturn(connection);</b>
<b class="fc">&nbsp;            when(preparedStatement.executeUpdate()).thenReturn(1);</b>
<b class="fc">&nbsp;            Utente u = new Utente(&quot;nome&quot;, &quot;cognome&quot;, &quot;luca@email.com&quot;, &quot;ciao&quot;, &quot;0123654789&quot;);</b>
<b class="fc">&nbsp;            boolean bool = UserManager.insertCliente(u);</b>
<b class="fc">&nbsp;            assertEquals(true, bool);</b>
&nbsp;
<b class="fc">&nbsp;        } catch (SQLException e) {</b>
<b class="nc">&nbsp;            throw new RuntimeException(e);</b>
<b class="fc">&nbsp;        }</b>
&nbsp;    }
&nbsp;
&nbsp;    @Test
&nbsp;    public void testinsertCliente_InsertError() throws SQLException {
<b class="fc">&nbsp;        try (MockedStatic&lt;ConPool&gt; utilities = Mockito.mockStatic(ConPool.class)) {</b>
<b class="fc">&nbsp;            utilities.when(ConPool::getConnection).thenReturn(connection);</b>
<b class="fc">&nbsp;            when(preparedStatement.executeUpdate()).thenReturn(0);</b>
<b class="fc">&nbsp;            Utente u = new Utente(&quot;nome&quot;, &quot;cognome&quot;, &quot;luca@email.com&quot;, &quot;ciao&quot;, &quot;0123654789&quot;);</b>
<b class="fc">&nbsp;            assertThrows(RuntimeException.class, () -&gt; {</b>
<b class="fc">&nbsp;                UserManager.insertCliente(u);</b>
&nbsp;            });
<b class="fc">&nbsp;        }</b>
&nbsp;    }
&nbsp;
&nbsp;    @Test
&nbsp;    public void testinsertCliente_SQLException() throws SQLException {
<b class="fc">&nbsp;        try (MockedStatic&lt;ConPool&gt; utilities = Mockito.mockStatic(ConPool.class)) {</b>
<b class="fc">&nbsp;            utilities.when(ConPool::getConnection).thenReturn(connection);</b>
<b class="fc">&nbsp;            when(connection.prepareStatement(&quot;INSERT INTO cliente (idCliente) VALUES (?)&quot;)).thenThrow(new SQLException());</b>
<b class="fc">&nbsp;            Utente u = new Utente(&quot;nome&quot;, &quot;cognome&quot;, &quot;luca@email.com&quot;, &quot;ciao&quot;, &quot;0123654789&quot;);</b>
&nbsp;
<b class="fc">&nbsp;            assertThrows(RuntimeException.class, () -&gt; {</b>
<b class="fc">&nbsp;                UserManager.insertCliente(u);</b>
&nbsp;            });
<b class="fc">&nbsp;        }</b>
&nbsp;    }
&nbsp;
&nbsp;    //delete user
&nbsp;    @Test
&nbsp;    public void testDeleteUser_Success() {
<b class="fc">&nbsp;        try (MockedStatic&lt;ConPool&gt; utilities = Mockito.mockStatic(ConPool.class)){</b>
<b class="fc">&nbsp;            utilities.when(ConPool::getConnection).thenReturn(connection);</b>
<b class="fc">&nbsp;            when(preparedStatement.executeUpdate()).thenReturn(1);</b>
<b class="fc">&nbsp;            boolean result = UserManager.deleteUser(27);</b>
<b class="fc">&nbsp;            assert (result == true);</b>
<b class="fc">&nbsp;        } catch (SQLException e) {</b>
<b class="nc">&nbsp;            throw new RuntimeException(e);</b>
<b class="fc">&nbsp;        }</b>
&nbsp;    }
&nbsp;
&nbsp;    @Test
&nbsp;    public void testDeleteUser_DeleteError() throws SQLException {
<b class="fc">&nbsp;        try (MockedStatic&lt;ConPool&gt; utilities = Mockito.mockStatic(ConPool.class)) {</b>
<b class="fc">&nbsp;            utilities.when(ConPool::getConnection).thenReturn(connection);</b>
<b class="fc">&nbsp;            when(preparedStatement.executeUpdate()).thenReturn(0);</b>
<b class="fc">&nbsp;            assertThrows(RuntimeException.class, () -&gt; {</b>
<b class="fc">&nbsp;                UserManager.deleteUser(30);</b>
&nbsp;            });
<b class="fc">&nbsp;        }</b>
&nbsp;    }
&nbsp;
&nbsp;    @Test
&nbsp;    public void testDeleteUser_SQLException() throws SQLException {
<b class="fc">&nbsp;        try (MockedStatic&lt;ConPool&gt; utilities = Mockito.mockStatic(ConPool.class)) {</b>
<b class="fc">&nbsp;            utilities.when(ConPool::getConnection).thenReturn(connection);</b>
<b class="fc">&nbsp;            when(connection.prepareStatement(&quot;DELETE FROM utente WHERE utente.id=?&quot;)).thenThrow(new SQLException());</b>
<b class="fc">&nbsp;            assertThrows(RuntimeException.class, () -&gt; {</b>
<b class="fc">&nbsp;                UserManager.deleteUser(30);</b>
&nbsp;            });
<b class="fc">&nbsp;        }</b>
&nbsp;    }
&nbsp;
&nbsp;    //insertGestore
&nbsp;
&nbsp;    /*@Test
&nbsp;    public void testInsertGestoreSuccess() throws SQLException {
&nbsp;        try (MockedStatic&lt;ConPool&gt; utilities = Mockito.mockStatic(ConPool.class)) {
&nbsp;            utilities.when(ConPool::getConnection).thenReturn(connection);
&nbsp;
&nbsp;            Utente u = mock(Utente.class);
&nbsp;            when(u.getNome()).thenReturn(&quot;nome&quot;);
&nbsp;            when(u.getCognome()).thenReturn(&quot;cognome&quot;);
&nbsp;            when(u.getEmail()).thenReturn(&quot;email&quot;);
&nbsp;            when(u.getPassword()).thenReturn(&quot;password&quot;);
&nbsp;            when(u.getTelefono()).thenReturn(&quot;telefono&quot;);
&nbsp;            when(u.getId()).thenReturn(1);
&nbsp;
&nbsp;            when(preparedStatement.executeUpdate()).thenReturn(1);
&nbsp;
&nbsp;            //when(preparedStatement.getGeneratedKeys()).thenReturn(resultSet);
&nbsp;            when(resultSet.next()).thenReturn(true);
&nbsp;            when(resultSet.getInt(1)).thenReturn(1);
&nbsp;
&nbsp;            Gestore g = mock(Gestore.class);
&nbsp;            when(g.getNome()).thenReturn(&quot;nome&quot;);
&nbsp;            when(g.getCognome()).thenReturn(&quot;cognome&quot;);
&nbsp;            when(g.getEmail()).thenReturn(&quot;email&quot;);
&nbsp;            when(g.getPassword()).thenReturn(&quot;password&quot;);
&nbsp;            when(g.getTelefono()).thenReturn(&quot;telefono&quot;);
&nbsp;            when(g.getTipoGestore()).thenReturn(&quot;contabile&quot;);
&nbsp;            when(g.getId()).thenReturn(1);
&nbsp;
&nbsp;            Contabile c = mock(Contabile.class);
&nbsp;            when(c.getId()).thenReturn(1);
&nbsp;            when(UserManager.insertContabile(g)).thenReturn(c);
&nbsp;
&nbsp;            Gestore result = UserManager.insertGestore(u, &quot;contabile&quot;);
&nbsp;
&nbsp;            assertEquals(1, result.getId());
&nbsp;        }
&nbsp;    }*/
&nbsp;}
</code>
</pre>
</div>

<script type="text/javascript">
(function() {
    var msie = false, msie9 = false;
    /*@cc_on
      msie = true;
      @if (@_jscript_version >= 9)
        msie9 = true;
      @end
    @*/

    if (!msie || msie && msie9) {
      hljs.highlightAll()
      hljs.initLineNumbersOnLoad();
    }
})();
</script>

<div class="footer">
    
    <div style="float:right;">generated on 2023-02-11 13:11</div>
</div>
</body>
</html>
